spec:
  id: SPEC-OPENCLAW-001
  name: OpenClaw Integration
  version: 1.0.0
  status: active

description: |
  OpenClaw integration for Dash v2.0 enabling primary model orchestration,
  agentic user support, and seamless connection to OpenClaw ecosystem.
  Allows Dash to use OpenClaw as orchestrator while maintaining autonomy.

requirements:
  - id: REQ-001
    description: GatewayClient connects to OpenClaw WebSocket
    priority: P0
    test: grep "GatewayClient\|WebSocket" src/integrations/openclaw/*.ts | wc -l | test "> 0"

  - id: REQ-002
    description: SessionManager handles swarm lifecycle
    priority: P0
    test: grep "SessionManager\|spawn\|kill\|history" src/integrations/openclaw/*.ts | wc -l | test "> 0"

  - id: REQ-003
    description: AgentExecutor manages agent lifecycle
    priority: P1
    test: grep "AgentExecutor\|execute\|terminate" src/integrations/openclaw/*.ts | wc -l | test "> 0"

  - id: REQ-004
    description: OpenClaw can orchestrate Dash swarms
    priority: P0
    test: scripts/orchestrator-v3.js --openclaw | grep "connected\|orchestrating" | test "not null"

  - id: REQ-005
    description: Dash can operate without OpenClaw (autonomous)
    priority: P0
    test: scripts/start-autonomous.sh --standalone | grep "standalone\|autonomous" | test "not null"

  - id: REQ-006
    description: Seamless handoff between OpenClaw and autonomous modes
    priority: P1
    test: scripts/mode-switch.sh --test | grep "switch\|handoff" | test "not null"

  - id: REQ-007
    description: Connection health monitored
    priority: P1
    test: cat .dash/openclaw-health.json 2>/dev/null | jq '.connected' | test "not null"

  - id: REQ-008
    description: Skills available to OpenClaw agents
    priority: P1
    test: grep "skills.*OpenClaw\|OpenClaw.*skills" OPENCLAW_INTEGRATION.md | test "not null"

implementation:
  files:
    - src/integrations/openclaw/GatewayClient.ts
    - src/integrations/openclaw/SessionManager.ts
    - src/integrations/openclaw/AgentExecutor.ts
    - src/integrations/openclaw/types.ts
    - scripts/orchestrator-v3.js
    - scripts/start-autonomous.sh
    - scripts/mode-switch.sh
    - OPENCLAW_INTEGRATION.md
    - .dash/openclaw-health.json

prompt_template: |
  You are implementing OpenClaw Integration for Dash v2.0.

  This integration enables:
  1. Primary model orchestration via OpenClaw
  2. Agentic user support
  3. Seamless mode switching (OpenClaw â†” Autonomous)
  4. Skills availability to OpenClaw agents

  Key Components:
  - GatewayClient - WebSocket connection to OpenClaw
  - SessionManager - Swarm lifecycle management
  - AgentExecutor - Agent control
  - Types - Protocol definitions

  Requirements:
  - [P0] GatewayClient connects to OpenClaw
  - [P0] SessionManager handles spawn/kill/history
  - [P1] AgentExecutor manages agents
  - [P0] OpenClaw can orchestrate Dash
  - [P0] Dash operates autonomously
  - [P1] Seamless mode handoff
  - [P1] Connection health monitored
  - [P1] Skills available to OpenClaw

  Implementation:
  - Use OpenClaw SDK/CLI patterns
  - Follow existing GatewayClient structure
  - Implement session management
  - Create mode switching logic
  - Monitor connection health
  - Document integration

  Success Criteria:
  - [ ] GatewayClient connects
  - [ ] SessionManager works
  - [ ] AgentExecutor functional
  - [ ] OpenClaw orchestration works
  - [ ] Autonomous mode works
  - [ ] Mode switching works
  - [ ] Health monitoring works
  - [ ] Skills available

validation:
  command: scripts/health-check.js --openclaw && scripts/mode-switch.sh --test
  coverage_threshold: 90

metadata:
  created: 2026-02-02
  author: Overnight Executive
  tags: [openclaw, integration, orchestration, agentic]
  related:
    - specs/active/skills-system.yaml
    - src/integrations/openclaw/*
    - PI_MONO_ASSESSMENT.md
